## 开普勒轨道的二体问题的基本模型
![[开普勒轨道二体示意图.png]]
根据万有引力的平方反比公式，作用在质点1和质点2上的力分别为：
$$ F_{1}=\frac{Gm_{1}m_{2}}{r^{3}}\mathbf r \tag{1}$$
$$ F_{2}=-\frac{Gm_{1}m_{2}}{r^{3}}\mathbf r\tag{2}$$
根据牛顿第二定律：(加速度方向与位矢的方向不一致)
$$ F_{1}=m_{1}\ddot{r_{1}}\tag{3}$$
$$ F_{2}=m_{2}\ddot{r_{2}}\tag{4}$$
显然可以得到：
$$F_{1}+F_{2}=m_{1}\ddot{r_{1}}+m_{2}\ddot{r_{2}}=0\tag{5}$$
对(5)进行两次积分后可以得到：
$$m_{1}r_{1}+m_{2}r_{2}=C_{1}t+C_{2}\tag{6}$$
二体的质心可以定义为：
$$R=\frac{m_{1}r_{1}+m_{2}r_{2}}{m_{1}+m_{2}}\tag{7}$$
将（6）式代入(7)式可以得到：
$$R=\frac{C_{1}t+C_{2}}{m_{1}+m_{2}}\tag{8}$$
从上式可以看出开普勒问题中，系统的质心静止或做匀速直线运动。（动量守恒）
## 基本运动方程
### 质点相对于质心的运动
选取一个新的惯性系，并让系统的质心（质心一直位于两个质点的连线上）位置始终位于原点，因此：
$$m_{1}r_{1}+m_{2}r_{2}=0\tag{9}$$
根据几何关系可以得到：
$$\vec{r_{2}}-\vec{r_{1}}=\vec{r}\tag{10}$$
由（9）和（10）式可以得到：
$$\vec{r}=\frac{m_{1}+m_{2}}{m_{1}}\vec{r_{2}}\tag{11}$$
将（111）代入（2）和（4）式:
$$\ddot{\vec{r_{2}}}+G\frac{m_{1}^{3}}{(m_{1}+m_{2})^{2}r_{2}^{3}} \vec{r_{2}}=0$$
### 质点相对于质点的运动
质点2相对于质点1的运动方程：
对式（10）两次求导可以得到：
$$\ddot{\vec{r_{2}}}-\ddot{\vec{r_{1}}}=\ddot{\vec{r}}\tag{12}$$
由（1）和（2）可以得到：
$$\ddot{\vec{r_{1}}}=\frac{Gm_{2}}{r^{3}}\vec{r}\tag{13}$$
$$\ddot{\vec{r_{2}}}=\frac{Gm_{1}}{r^{3}}\vec{r}\tag{14}$$
将（13）和（14）联立：
$$\ddot{\vec{r}}+G\frac{m_{1}+m_{2}}{r^{3}}\vec{r}=0\tag{15}$$
令$u=G(m_{1}+m_{2})$,得到：
$$\ddot{\vec{r}}+\frac{u}{r^{3}}\vec{r}=0\tag{16}$$
（11）和（16）具有相同形式。
## 角动量守恒
使用$\vec{r}$对式（16）进行叉乘可以得到：
$$\vec{r}×(\ddot{\vec{r}}+\frac{u}{r^{3}}\vec{r})=0\tag{17}$$
$$\vec{r}×\ddot{\vec{r}}=0$$
对叉乘结果进行积分可以得到:

$$\vec{r}×\dot{\vec{r}}=h$$
因为$h$是一个积分常数，所以是一个常值。$h$的物理意义是单位质量下的角动量，因此可以得到角动量守恒的结果。
## 极坐标系下的微分方程
利用极坐标将矢量微分方程标量化：
![[开普勒矢量方程标量化.png]]
## 微分方程求解
![[积分变换.png]]
通过求解可以得到以上方程的通解为：
$$r=\frac{p}{1+ecos(\theta+\phi)}\tag{25}$$
式中$p=\frac{u}{h^{2}}$。当e=0时，轨迹为圆，0<e<1时，轨迹为椭圆，当e=1时，轨迹为抛物线，当e>1时，轨迹为双曲线。
## 角动量守恒
在相等的时间内，太阳和运动行星的连线所扫过的面积是相等的：
$$r^2\dot{\theta}=h\tag{26}$$
如下图所示：
![[角动量守恒.png]]
## 开普勒方程
将式（26）进行改写，可以得到：
$$\frac{u^{2}}{h^{3}}dt=\frac{1}{(1+ecos(\theta))^2}d\theta$$

假设质点过轨道近拱点时的时刻为$t_{p}$，此时$\theta=0$,上式可以写为：
$$\frac{u^{2}}{h^{3}}(t-t_{p})=\int_{0}^{\theta}\frac{1}{(1+ecos(\phi))^2}d\phi$$
通过积分求解，可以得到：
$$\int_{0}^{\theta}\frac{1}{(1+ecos(\phi))^2}d\phi=\frac{esin(\theta)}{(e^2-1)(ecos(\theta)+1)}-\frac{2tan^{-1}(\frac{(e-1)tan(\theta/2)}{\sqrt{e^2-1}})}{(e^2-1)^{3/2}}$$
针对椭圆轨道0<e<1，可以得到：
![[化简.png]]
真近点角、平近点角、偏近点角。
[开普勒方程与轨道参数 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/20703852)****
偏近点角与真近点角有如下的关系：
$$cosE=\frac{e+cos\theta}{1+ecos\theta}$$
$$sinE=\frac{\sqrt{1-e^{2}} sin \theta}{1+ecos\theta}$$
从而可以得到二分角正切值的之间的关系：
$$tan\frac{E}{2}=\sqrt{\frac{1+e}{1-e}}tan\frac{\theta}{2}$$
$$E=2tan^{-1}(\sqrt{\frac{1-e}{1+e}}tan(\frac{\theta}{2}))$$
结合图片中的（10）式可以得到，简化版的开普勒方程：
$$M=E-esinE$$
